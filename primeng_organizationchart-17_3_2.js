import{style as d,state as x,animate as g,transition as h,trigger as b}from"@angular/animations";import*as l from"@angular/common";import{CommonModule as z}from"@angular/common";import*as e from"@angular/core";import{forwardRef as N,EventEmitter as s}from"@angular/core";import{PrimeTemplate as S,SharedModule as _}from"primeng/api";import{DomHandler as m}from"primeng/dom";import{ChevronDownIcon as f}from"primeng/icons/chevrondown";import{ChevronUpIcon as C}from"primeng/icons/chevronup";import{Subject as I}from"rxjs";var T=["pOrganizationChartNode",""];function O(n,a){if(n&1&&(e.ɵɵelementStart(0,"div"),e.ɵɵtext(1),e.ɵɵelementEnd()),n&2){let t=e.ɵɵnextContext(2);e.ɵɵadvance(1),e.ɵɵtextInterpolate(t.node.label)}}function w(n,a){n&1&&e.ɵɵelementContainer(0)}var y=n=>({$implicit:n});function E(n,a){if(n&1&&(e.ɵɵelementStart(0,"div"),e.ɵɵtemplate(1,w,1,0,"ng-container",7),e.ɵɵelementEnd()),n&2){let t=e.ɵɵnextContext(2);e.ɵɵadvance(1),e.ɵɵproperty("ngTemplateOutlet",t.chart.getTemplateForNode(t.node))("ngTemplateOutletContext",e.ɵɵpureFunction1(2,y,t.node))}}var p=()=>({display:"inline"});function M(n,a){n&1&&e.ɵɵelement(0,"ChevronDownIcon",11),n&2&&(e.ɵɵproperty("styleClass","p-node-toggler-icon")("ngStyle",e.ɵɵpureFunction0(3,p)),e.ɵɵattribute("data-pc-section","nodeTogglerIcon"))}function k(n,a){n&1&&e.ɵɵelement(0,"ChevronUpIcon",11),n&2&&(e.ɵɵproperty("styleClass","p-node-toggler-icon")("ngStyle",e.ɵɵpureFunction0(3,p)),e.ɵɵattribute("data-pc-section","nodeTogglerIcon"))}function F(n,a){if(n&1&&(e.ɵɵelementContainerStart(0),e.ɵɵtemplate(1,M,1,4,"ChevronDownIcon",10)(2,k,1,4,"ChevronUpIcon",10),e.ɵɵelementContainerEnd()),n&2){let t=e.ɵɵnextContext(3);e.ɵɵadvance(1),e.ɵɵproperty("ngIf",t.node.expanded),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",!t.node.expanded)}}function D(n,a){}function V(n,a){n&1&&e.ɵɵtemplate(0,D,0,0,"ng-template")}function U(n,a){if(n&1&&(e.ɵɵelementStart(0,"span",12),e.ɵɵtemplate(1,V,1,0,null,7),e.ɵɵelementEnd()),n&2){let t=e.ɵɵnextContext(3);e.ɵɵproperty("ngStyle",e.ɵɵpureFunction0(4,p)),e.ɵɵattribute("data-pc-section","nodeTogglerIcon"),e.ɵɵadvance(1),e.ɵɵproperty("ngTemplateOutlet",t.chart.togglerIconTemplate)("ngTemplateOutletContext",e.ɵɵpureFunction1(5,y,t.node.expanded))}}function j(n,a){if(n&1){let t=e.ɵɵgetCurrentView();e.ɵɵelementStart(0,"a",8),e.ɵɵlistener("click",function(o){e.ɵɵrestoreView(t);let r=e.ɵɵnextContext(2);return e.ɵɵresetView(r.toggleNode(o,r.node))})("keydown.enter",function(o){e.ɵɵrestoreView(t);let r=e.ɵɵnextContext(2);return e.ɵɵresetView(r.toggleNode(o,r.node))})("keydown.space",function(o){e.ɵɵrestoreView(t);let r=e.ɵɵnextContext(2);return e.ɵɵresetView(r.toggleNode(o,r.node))}),e.ɵɵtemplate(1,F,3,2,"ng-container",0)(2,U,2,7,"span",9),e.ɵɵelementEnd()}if(n&2){let t=e.ɵɵnextContext(2);e.ɵɵattribute("data-pc-section","nodeToggler"),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",!t.chart.togglerIconTemplate),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",t.chart.togglerIconTemplate)}}function R(n,a){if(n&1&&(e.ɵɵelementContainerStart(0),e.ɵɵelementStart(1,"td"),e.ɵɵelement(2,"div",4),e.ɵɵelementEnd(),e.ɵɵelementContainerEnd()),n&2){let t=e.ɵɵnextContext(2);e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","lineCell")("colspan",t.colspan),e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","lineDown")}}var u=n=>({"p-organizationchart-line-top":n});function A(n,a){if(n&1&&(e.ɵɵelementStart(0,"td",14),e.ɵɵtext(1,"\xA0"),e.ɵɵelementEnd(),e.ɵɵelementStart(2,"td",15),e.ɵɵtext(3,"\xA0"),e.ɵɵelementEnd()),n&2){let t=a.first,i=a.last;e.ɵɵproperty("ngClass",e.ɵɵpureFunction1(4,u,!t)),e.ɵɵattribute("data-pc-section","lineLeft"),e.ɵɵadvance(2),e.ɵɵproperty("ngClass",e.ɵɵpureFunction1(6,u,!i)),e.ɵɵattribute("data-pc-section","lineRight")}}function Q(n,a){if(n&1&&(e.ɵɵelementContainerStart(0),e.ɵɵtemplate(1,A,4,8,"ng-template",13),e.ɵɵelementContainerEnd()),n&2){let t=e.ɵɵnextContext(2);e.ɵɵadvance(1),e.ɵɵproperty("ngForOf",t.node.children)}}function $(n,a){if(n&1&&(e.ɵɵelementStart(0,"td",16),e.ɵɵelement(1,"table",17),e.ɵɵelementEnd()),n&2){let t=a.$implicit;e.ɵɵattribute("data-pc-section","nodeCell"),e.ɵɵadvance(1),e.ɵɵproperty("node",t)}}var q=(n,a)=>({"p-organizationchart-node-content":!0,"p-organizationchart-selectable-node":n,"p-highlight":a});function H(n,a){if(n&1){let t=e.ɵɵgetCurrentView();e.ɵɵelementStart(0,"tbody")(1,"tr")(2,"td")(3,"div",1),e.ɵɵlistener("click",function(o){e.ɵɵrestoreView(t);let r=e.ɵɵnextContext();return e.ɵɵresetView(r.onNodeClick(o,r.node))}),e.ɵɵtemplate(4,O,2,1,"div",0)(5,E,2,4,"div",0)(6,j,3,3,"a",2),e.ɵɵelementEnd()()(),e.ɵɵelementStart(7,"tr",3)(8,"td"),e.ɵɵelement(9,"div",4),e.ɵɵelementEnd()(),e.ɵɵelementStart(10,"tr",3),e.ɵɵtemplate(11,R,3,3,"ng-container",0)(12,Q,2,1,"ng-container",0),e.ɵɵelementEnd(),e.ɵɵelementStart(13,"tr",5),e.ɵɵtemplate(14,$,2,2,"td",6),e.ɵɵelementEnd()()}if(n&2){let t=e.ɵɵnextContext();e.ɵɵattribute("data-pc-section","body"),e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","row"),e.ɵɵadvance(1),e.ɵɵattribute("colspan",t.colspan)("data-pc-section","cell"),e.ɵɵadvance(1),e.ɵɵclassMap(t.node.styleClass),e.ɵɵproperty("ngClass",e.ɵɵpureFunction2(26,q,t.chart.selectionMode&&t.node.selectable!==!1,t.isSelected())),e.ɵɵattribute("data-pc-section","node"),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",!t.chart.getTemplateForNode(t.node)),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",t.chart.getTemplateForNode(t.node)),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",!t.leaf),e.ɵɵadvance(1),e.ɵɵproperty("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.ɵɵattribute("data-pc-section","lines"),e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","lineCell")("colspan",t.colspan),e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","lineDown"),e.ɵɵadvance(1),e.ɵɵproperty("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.ɵɵattribute("data-pc-section","lines"),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",t.node.children&&t.node.children.length===1),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",t.node.children&&t.node.children.length>1),e.ɵɵadvance(1),e.ɵɵproperty("ngClass",!t.leaf&&t.node.expanded?"p-organizationchart-node-visible":"p-organizationchart-node-hidden")("@childState","in"),e.ɵɵattribute("data-pc-section","nodes"),e.ɵɵadvance(1),e.ɵɵproperty("ngForOf",t.node.children)}}function L(n,a){if(n&1&&e.ɵɵelement(0,"table",2),n&2){let t=e.ɵɵnextContext();e.ɵɵproperty("node",t.root)}}var P=n=>({"p-organizationchart p-component":!0,"p-organizationchart-preservespace":n}),B=(()=>{class n{cd;node;root;first;last;chart;subscription;constructor(t,i){this.cd=i,this.chart=t,this.subscription=this.chart.selectionSource$.subscribe(()=>{this.cd.markForCheck()})}get leaf(){if(this.node)return this.node.leaf==!1?!1:!(this.node.children&&this.node.children.length)}get colspan(){if(this.node)return this.node.children&&this.node.children.length?this.node.children.length*2:null}onNodeClick(t,i){this.chart.onNodeClick(t,i)}toggleNode(t,i){i.expanded=!i.expanded,i.expanded?this.chart.onNodeExpand.emit({originalEvent:t,node:this.node}):this.chart.onNodeCollapse.emit({originalEvent:t,node:this.node}),t.preventDefault()}isSelected(){return this.chart.isSelected(this.node)}ngOnDestroy(){this.subscription.unsubscribe()}static ɵfac=function(i){return new(i||n)(e.ɵɵdirectiveInject(N(()=>G)),e.ɵɵdirectiveInject(e.ChangeDetectorRef))};static ɵcmp=e.ɵɵdefineComponent({type:n,selectors:[["","pOrganizationChartNode",""]],hostAttrs:[1,"p-element"],inputs:{node:"node",root:"root",first:"first",last:"last"},attrs:T,decls:1,vars:1,consts:[[4,"ngIf"],[3,"ngClass","click"],["tabindex","0","class","p-node-toggler",3,"click","keydown.enter","keydown.space",4,"ngIf"],[1,"p-organizationchart-lines",3,"ngClass"],[1,"p-organizationchart-line-down"],[1,"p-organizationchart-nodes",3,"ngClass"],["colspan","2",4,"ngFor","ngForOf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","0",1,"p-node-toggler",3,"click","keydown.enter","keydown.space"],["class","p-node-toggler-icon",3,"ngStyle",4,"ngIf"],[3,"styleClass","ngStyle",4,"ngIf"],[3,"styleClass","ngStyle"],[1,"p-node-toggler-icon",3,"ngStyle"],["ngFor","",3,"ngForOf"],[1,"p-organizationchart-line-left",3,"ngClass"],[1,"p-organizationchart-line-right",3,"ngClass"],["colspan","2"],["pOrganizationChartNode","",1,"p-organizationchart-table",3,"node"]],template:function(i,o){i&1&&e.ɵɵtemplate(0,H,15,29,"tbody",0),i&2&&e.ɵɵproperty("ngIf",o.node)},dependencies:()=>[l.NgClass,l.NgForOf,l.NgIf,l.NgTemplateOutlet,l.NgStyle,f,C,n],styles:[`@layer primeng{.p-organizationchart-table{border-spacing:0;border-collapse:separate;margin:0 auto}.p-organizationchart-table>tbody>tr>td{text-align:center;vertical-align:top;padding:0 .75rem}.p-organizationchart-node-content{display:inline-block;position:relative}.p-organizationchart-node-content .p-node-toggler{position:absolute;bottom:-.75rem;margin-left:-.75rem;z-index:2;left:50%;-webkit-user-select:none;user-select:none;cursor:pointer;width:1.5rem;height:1.5rem}.p-organizationchart-node-content .p-node-toggler .p-node-toggler-icon{position:relative;top:.25rem}.p-organizationchart-line-down{margin:0 auto;height:20px;width:1px}.p-organizationchart-line-right,.p-organizationchart-line-left{border-radius:0}.p-organizationchart-selectable-node{cursor:pointer}.p-organizationchart .p-organizationchart-node-hidden{display:none}.p-organizationchart-preservespace .p-organizationchart-node-hidden{visibility:hidden;display:inherit}}
`],encapsulation:2,data:{animation:[b("childState",[x("in",d({opacity:1})),h("void => *",[d({opacity:0}),g(150)]),h("* => void",[g(150,d({opacity:0}))])])]}})}return n})(),G=(()=>{class n{el;cd;value;style;styleClass;selectionMode;preserveSpace=!0;get selection(){return this._selection}set selection(t){this._selection=t,this.initialized&&this.selectionSource.next(null)}selectionChange=new s;onNodeSelect=new s;onNodeUnselect=new s;onNodeExpand=new s;onNodeCollapse=new s;templates;templateMap;togglerIconTemplate;selectionSource=new I;_selection;initialized;selectionSource$=this.selectionSource.asObservable();constructor(t,i){this.el=t,this.cd=i}get root(){return this.value&&this.value.length?this.value[0]:null}ngAfterContentInit(){this.templates.length&&(this.templateMap={}),this.templates.forEach(t=>{t.getType()==="togglericon"?this.togglerIconTemplate=t.template:this.templateMap[t.getType()]=t.template}),this.initialized=!0}getTemplateForNode(t){return this.templateMap?t.type?this.templateMap[t.type]:this.templateMap.default:null}onNodeClick(t,i){let o=t.target;if(!(o.className&&(m.hasClass(o,"p-node-toggler")||m.hasClass(o,"p-node-toggler-icon")))&&this.selectionMode){if(i.selectable===!1)return;let r=this.findIndexInSelection(i),c=r>=0;this.selectionMode==="single"?c?(this.selection=null,this.onNodeUnselect.emit({originalEvent:t,node:i})):(this.selection=i,this.onNodeSelect.emit({originalEvent:t,node:i})):this.selectionMode==="multiple"&&(c?(this.selection=this.selection.filter((J,v)=>v!=r),this.onNodeUnselect.emit({originalEvent:t,node:i})):(this.selection=[...(this.selection||[]),i],this.onNodeSelect.emit({originalEvent:t,node:i}))),this.selectionChange.emit(this.selection),this.selectionSource.next(null)}}findIndexInSelection(t){let i=-1;if(this.selectionMode&&this.selection){if(this.selectionMode==="single")i=this.selection==t?0:-1;else if(this.selectionMode==="multiple"){for(let o=0;o<this.selection.length;o++)if(this.selection[o]==t){i=o;break}}}return i}isSelected(t){return this.findIndexInSelection(t)!=-1}static ɵfac=function(i){return new(i||n)(e.ɵɵdirectiveInject(e.ElementRef),e.ɵɵdirectiveInject(e.ChangeDetectorRef))};static ɵcmp=e.ɵɵdefineComponent({type:n,selectors:[["p-organizationChart"]],contentQueries:function(i,o,r){if(i&1&&e.ɵɵcontentQuery(r,S,4),i&2){let c;e.ɵɵqueryRefresh(c=e.ɵɵloadQuery())&&(o.templates=c)}},hostAttrs:[1,"p-element"],inputs:{value:"value",style:"style",styleClass:"styleClass",selectionMode:"selectionMode",preserveSpace:"preserveSpace",selection:"selection"},outputs:{selectionChange:"selectionChange",onNodeSelect:"onNodeSelect",onNodeUnselect:"onNodeUnselect",onNodeExpand:"onNodeExpand",onNodeCollapse:"onNodeCollapse"},decls:2,vars:8,consts:[[3,"ngStyle","ngClass"],["class","p-organizationchart-table","pOrganizationChartNode","",3,"node",4,"ngIf"],["pOrganizationChartNode","",1,"p-organizationchart-table",3,"node"]],template:function(i,o){i&1&&(e.ɵɵelementStart(0,"div",0),e.ɵɵtemplate(1,L,1,1,"table",1),e.ɵɵelementEnd()),i&2&&(e.ɵɵclassMap(o.styleClass),e.ɵɵproperty("ngStyle",o.style)("ngClass",e.ɵɵpureFunction1(6,P,o.preserveSpace)),e.ɵɵattribute("data-pc-section","root"),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",o.root))},dependencies:[l.NgClass,l.NgIf,l.NgStyle,B],encapsulation:2})}return n})(),pe=(()=>{class n{static ɵfac=function(i){return new(i||n)};static ɵmod=e.ɵɵdefineNgModule({type:n});static ɵinj=e.ɵɵdefineInjector({imports:[z,f,C,_,_]})}return n})();export{G as OrganizationChart,pe as OrganizationChartModule,B as OrganizationChartNode};