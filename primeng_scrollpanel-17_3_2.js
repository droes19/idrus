import*as h from"@angular/common";import{isPlatformBrowser as w,DOCUMENT as v,CommonModule as b}from"@angular/common";import*as e from"@angular/core";import{PLATFORM_ID as g}from"@angular/core";import{PrimeTemplate as y}from"primeng/api";import{DomHandler as r}from"primeng/dom";import{UniqueComponentId as B}from"primeng/utils";var C=["container"],M=["content"],_=["xBar"],L=["yBar"];function D(l,S){l&1&&e.ɵɵelementContainer(0)}var T=["*"],U=(()=>{class l{platformId;el;zone;cd;document;renderer;style;styleClass;step=5;containerViewChild;contentViewChild;xBarViewChild;yBarViewChild;templates;scrollYRatio;scrollXRatio;timeoutFrame=t=>setTimeout(t,0);initialized=!1;lastPageY;lastPageX;isXBarClicked=!1;isYBarClicked=!1;contentTemplate;lastScrollLeft=0;lastScrollTop=0;orientation="vertical";timer;contentId;windowResizeListener;contentScrollListener;mouseEnterListener;xBarMouseDownListener;yBarMouseDownListener;documentMouseMoveListener;documentMouseUpListener;constructor(t,n,i,o,s,c){this.platformId=t,this.el=n,this.zone=i,this.cd=o,this.document=s,this.renderer=c,this.contentId=B()+"_content"}ngAfterViewInit(){w(this.platformId)&&this.zone.runOutsideAngular(()=>{this.moveBar(),this.moveBar=this.moveBar.bind(this),this.onXBarMouseDown=this.onXBarMouseDown.bind(this),this.onYBarMouseDown=this.onYBarMouseDown.bind(this),this.onDocumentMouseMove=this.onDocumentMouseMove.bind(this),this.onDocumentMouseUp=this.onDocumentMouseUp.bind(this),this.windowResizeListener=this.renderer.listen(window,"resize",this.moveBar),this.contentScrollListener=this.renderer.listen(this.contentViewChild.nativeElement,"scroll",this.moveBar),this.mouseEnterListener=this.renderer.listen(this.contentViewChild.nativeElement,"mouseenter",this.moveBar),this.xBarMouseDownListener=this.renderer.listen(this.xBarViewChild.nativeElement,"mousedown",this.onXBarMouseDown),this.yBarMouseDownListener=this.renderer.listen(this.yBarViewChild.nativeElement,"mousedown",this.onYBarMouseDown),this.calculateContainerHeight(),this.initialized=!0})}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"content":this.contentTemplate=t.template;break;default:this.contentTemplate=t.template;break}})}calculateContainerHeight(){let t=this.containerViewChild.nativeElement,n=this.contentViewChild.nativeElement,i=this.xBarViewChild.nativeElement,o=this.document.defaultView,s=o.getComputedStyle(t),c=o.getComputedStyle(i),a=r.getHeight(t)-parseInt(c.height,10);s["max-height"]!="none"&&a==0&&(n.offsetHeight+parseInt(c.height,10)>parseInt(s["max-height"],10)?t.style.height=s["max-height"]:t.style.height=n.offsetHeight+parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth)+"px")}moveBar(){let t=this.containerViewChild.nativeElement,n=this.contentViewChild.nativeElement,i=this.xBarViewChild.nativeElement,o=n.scrollWidth,s=n.clientWidth,c=(t.clientHeight-i.clientHeight)*-1;this.scrollXRatio=s/o;let a=this.yBarViewChild.nativeElement,p=n.scrollHeight,m=n.clientHeight,f=(t.clientWidth-a.clientWidth)*-1;this.scrollYRatio=m/p,this.requestAnimationFrame(()=>{if(this.scrollXRatio>=1)i.setAttribute("data-p-scrollpanel-hidden","true"),r.addClass(i,"p-scrollpanel-hidden");else{i.setAttribute("data-p-scrollpanel-hidden","false"),r.removeClass(i,"p-scrollpanel-hidden");let d=Math.max(this.scrollXRatio*100,10),u=n.scrollLeft*(100-d)/(o-s);i.style.cssText="width:"+d+"%; left:"+u+"%;bottom:"+c+"px;"}if(this.scrollYRatio>=1)a.setAttribute("data-p-scrollpanel-hidden","true"),r.addClass(a,"p-scrollpanel-hidden");else{a.setAttribute("data-p-scrollpanel-hidden","false"),r.removeClass(a,"p-scrollpanel-hidden");let d=Math.max(this.scrollYRatio*100,10),u=n.scrollTop*(100-d)/(p-m);a.style.cssText="height:"+d+"%; top: calc("+u+"% - "+i.clientHeight+"px);right:"+f+"px;"}}),this.cd.markForCheck()}onScroll(t){this.lastScrollLeft!==t.target.scrollLeft?(this.lastScrollLeft=t.target.scrollLeft,this.orientation="horizontal"):this.lastScrollTop!==t.target.scrollTop&&(this.lastScrollTop=t.target.scrollTop,this.orientation="vertical"),this.moveBar()}onKeyDown(t){if(this.orientation==="vertical")switch(t.code){case"ArrowDown":{this.setTimer("scrollTop",this.step),t.preventDefault();break}case"ArrowUp":{this.setTimer("scrollTop",this.step*-1),t.preventDefault();break}case"ArrowLeft":case"ArrowRight":{t.preventDefault();break}default:break}else if(this.orientation==="horizontal")switch(t.code){case"ArrowRight":{this.setTimer("scrollLeft",this.step),t.preventDefault();break}case"ArrowLeft":{this.setTimer("scrollLeft",this.step*-1),t.preventDefault();break}case"ArrowDown":case"ArrowUp":{t.preventDefault();break}default:break}}onKeyUp(){this.clearTimer()}repeat(t,n){this.contentViewChild.nativeElement[t]+=n,this.moveBar()}setTimer(t,n){this.clearTimer(),this.timer=setTimeout(()=>{this.repeat(t,n)},40)}clearTimer(){this.timer&&clearTimeout(this.timer)}bindDocumentMouseListeners(){this.documentMouseMoveListener||(this.documentMouseMoveListener=t=>{this.onDocumentMouseMove(t)},this.document.addEventListener("mousemove",this.documentMouseMoveListener)),this.documentMouseUpListener||(this.documentMouseUpListener=t=>{this.onDocumentMouseUp(t)},this.document.addEventListener("mouseup",this.documentMouseUpListener))}unbindDocumentMouseListeners(){this.documentMouseMoveListener&&(this.document.removeEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseMoveListener=null),this.documentMouseUpListener&&(document.removeEventListener("mouseup",this.documentMouseUpListener),this.documentMouseUpListener=null)}onYBarMouseDown(t){this.isYBarClicked=!0,this.yBarViewChild.nativeElement.focus(),this.lastPageY=t.pageY,this.yBarViewChild.nativeElement.setAttribute("data-p-scrollpanel-grabbed","true"),r.addClass(this.yBarViewChild.nativeElement,"p-scrollpanel-grabbed"),this.document.body.setAttribute("data-p-scrollpanel-grabbed","true"),r.addClass(this.document.body,"p-scrollpanel-grabbed"),this.bindDocumentMouseListeners(),t.preventDefault()}onXBarMouseDown(t){this.isXBarClicked=!0,this.xBarViewChild.nativeElement.focus(),this.lastPageX=t.pageX,this.xBarViewChild.nativeElement.setAttribute("data-p-scrollpanel-grabbed","false"),r.addClass(this.xBarViewChild.nativeElement,"p-scrollpanel-grabbed"),this.document.body.setAttribute("data-p-scrollpanel-grabbed","false"),r.addClass(this.document.body,"p-scrollpanel-grabbed"),this.bindDocumentMouseListeners(),t.preventDefault()}onDocumentMouseMove(t){this.isXBarClicked?this.onMouseMoveForXBar(t):this.isYBarClicked?this.onMouseMoveForYBar(t):(this.onMouseMoveForXBar(t),this.onMouseMoveForYBar(t))}onMouseMoveForXBar(t){let n=t.pageX-this.lastPageX;this.lastPageX=t.pageX,this.requestAnimationFrame(()=>{this.contentViewChild.nativeElement.scrollLeft+=n/this.scrollXRatio})}onMouseMoveForYBar(t){let n=t.pageY-this.lastPageY;this.lastPageY=t.pageY,this.requestAnimationFrame(()=>{this.contentViewChild.nativeElement.scrollTop+=n/this.scrollYRatio})}scrollTop(t){let n=this.contentViewChild.nativeElement.scrollHeight-this.contentViewChild.nativeElement.clientHeight;t=t>n?n:t>0?t:0,this.contentViewChild.nativeElement.scrollTop=t}onFocus(t){this.xBarViewChild.nativeElement.isSameNode(t.target)?this.orientation="horizontal":this.yBarViewChild.nativeElement.isSameNode(t.target)&&(this.orientation="vertical")}onBlur(){this.orientation==="horizontal"&&(this.orientation="vertical")}onDocumentMouseUp(t){this.yBarViewChild.nativeElement.setAttribute("data-p-scrollpanel-grabbed","false"),r.removeClass(this.yBarViewChild.nativeElement,"p-scrollpanel-grabbed"),this.xBarViewChild.nativeElement.setAttribute("data-p-scrollpanel-grabbed","false"),r.removeClass(this.xBarViewChild.nativeElement,"p-scrollpanel-grabbed"),this.document.body.setAttribute("data-p-scrollpanel-grabbed","false"),r.removeClass(this.document.body,"p-scrollpanel-grabbed"),this.unbindDocumentMouseListeners(),this.isXBarClicked=!1,this.isYBarClicked=!1}requestAnimationFrame(t){(window.requestAnimationFrame||this.timeoutFrame)(t)}unbindListeners(){this.windowResizeListener&&(this.windowResizeListener(),this.windowResizeListener=null),this.contentScrollListener&&(this.contentScrollListener(),this.contentScrollListener=null),this.mouseEnterListener&&(this.mouseEnterListener(),this.mouseEnterListener=null),this.xBarMouseDownListener&&(this.xBarMouseDownListener(),this.xBarMouseDownListener=null),this.yBarMouseDownListener&&(this.yBarMouseDownListener(),this.yBarMouseDownListener=null)}ngOnDestroy(){this.initialized&&this.unbindListeners()}refresh(){this.moveBar()}static ɵfac=function(n){return new(n||l)(e.ɵɵdirectiveInject(g),e.ɵɵdirectiveInject(e.ElementRef),e.ɵɵdirectiveInject(e.NgZone),e.ɵɵdirectiveInject(e.ChangeDetectorRef),e.ɵɵdirectiveInject(v),e.ɵɵdirectiveInject(e.Renderer2))};static ɵcmp=e.ɵɵdefineComponent({type:l,selectors:[["p-scrollPanel"]],contentQueries:function(n,i,o){if(n&1&&e.ɵɵcontentQuery(o,y,4),n&2){let s;e.ɵɵqueryRefresh(s=e.ɵɵloadQuery())&&(i.templates=s)}},viewQuery:function(n,i){if(n&1&&(e.ɵɵviewQuery(C,5),e.ɵɵviewQuery(M,5),e.ɵɵviewQuery(_,5),e.ɵɵviewQuery(L,5)),n&2){let o;e.ɵɵqueryRefresh(o=e.ɵɵloadQuery())&&(i.containerViewChild=o.first),e.ɵɵqueryRefresh(o=e.ɵɵloadQuery())&&(i.contentViewChild=o.first),e.ɵɵqueryRefresh(o=e.ɵɵloadQuery())&&(i.xBarViewChild=o.first),e.ɵɵqueryRefresh(o=e.ɵɵloadQuery())&&(i.yBarViewChild=o.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",step:"step"},ngContentSelectors:T,decls:11,vars:16,consts:[[3,"ngClass","ngStyle"],["container",""],[1,"p-scrollpanel-wrapper"],[1,"p-scrollpanel-content",3,"mouseenter","scroll"],["content",""],[4,"ngTemplateOutlet"],["tabindex","0","role","scrollbar",1,"p-scrollpanel-bar","p-scrollpanel-bar-x",3,"mousedown","keydown","keyup","focus","blur"],["xBar",""],["tabindex","0","role","scrollbar",1,"p-scrollpanel-bar","p-scrollpanel-bar-y",3,"mousedown","keydown","keyup","focus"],["yBar",""]],template:function(n,i){n&1&&(e.ɵɵprojectionDef(),e.ɵɵelementStart(0,"div",0,1)(2,"div",2)(3,"div",3,4),e.ɵɵlistener("mouseenter",function(){return i.moveBar()})("scroll",function(s){return i.onScroll(s)}),e.ɵɵprojection(5),e.ɵɵtemplate(6,D,1,0,"ng-container",5),e.ɵɵelementEnd()(),e.ɵɵelementStart(7,"div",6,7),e.ɵɵlistener("mousedown",function(s){return i.onXBarMouseDown(s)})("keydown",function(s){return i.onKeyDown(s)})("keyup",function(){return i.onKeyUp()})("focus",function(s){return i.onFocus(s)})("blur",function(){return i.onBlur()}),e.ɵɵelementEnd(),e.ɵɵelementStart(9,"div",8,9),e.ɵɵlistener("mousedown",function(s){return i.onYBarMouseDown(s)})("keydown",function(s){return i.onKeyDown(s)})("keyup",function(){return i.onKeyUp()})("focus",function(s){return i.onFocus(s)}),e.ɵɵelementEnd()()),n&2&&(e.ɵɵclassMap(i.styleClass),e.ɵɵproperty("ngClass","p-scrollpanel p-component")("ngStyle",i.style),e.ɵɵattribute("data-pc-name","scrollpanel"),e.ɵɵadvance(2),e.ɵɵattribute("data-pc-section","wrapper"),e.ɵɵadvance(1),e.ɵɵattribute("data-pc-section","content"),e.ɵɵadvance(3),e.ɵɵproperty("ngTemplateOutlet",i.contentTemplate),e.ɵɵadvance(1),e.ɵɵattribute("aria-orientation","horizontal")("aria-valuenow",i.lastScrollLeft)("data-pc-section","barx")("aria-controls",i.contentId),e.ɵɵadvance(2),e.ɵɵattribute("aria-orientation","vertical")("aria-valuenow",i.lastScrollTop)("data-pc-section","bary")("aria-controls",i.contentId))},dependencies:[h.NgClass,h.NgTemplateOutlet,h.NgStyle],styles:[`@layer primeng{.p-scrollpanel-wrapper{overflow:hidden;width:100%;height:100%;position:relative;float:left}.p-scrollpanel-content{height:calc(100% + 18px);width:calc(100% + 18px);padding:0 18px 18px 0;position:relative;overflow:auto;box-sizing:border-box}.p-scrollpanel-bar{position:relative;background:#c1c1c1;border-radius:3px;cursor:pointer;opacity:0;transition:opacity .25s linear}.p-scrollpanel-bar-y{width:9px;top:0}.p-scrollpanel-bar-x{height:9px;bottom:0}.p-scrollpanel-hidden{visibility:hidden}.p-scrollpanel:hover .p-scrollpanel-bar,.p-scrollpanel:active .p-scrollpanel-bar{opacity:1}.p-scrollpanel-grabbed{-webkit-user-select:none;user-select:none}}
`],encapsulation:2,changeDetection:0})}return l})(),Q=(()=>{class l{static ɵfac=function(n){return new(n||l)};static ɵmod=e.ɵɵdefineNgModule({type:l});static ɵinj=e.ɵɵdefineInjector({imports:[b]})}return l})();export{U as ScrollPanel,Q as ScrollPanelModule};