import*as r from"@angular/common";import{DOCUMENT as h,CommonModule as d}from"@angular/common";import*as e from"@angular/core";import{forwardRef as u,EventEmitter as m}from"@angular/core";import{NG_VALUE_ACCESSOR as c}from"@angular/forms";function p(o,w){if(o&1&&(e.ɵɵnamespaceSVG(),e.ɵɵelementStart(0,"text",5),e.ɵɵtext(1),e.ɵɵelementEnd()),o&2){let t=e.ɵɵnextContext();e.ɵɵattribute("x",50)("y",57)("fill",t.textColor)("name",t.name),e.ɵɵadvance(1),e.ɵɵtextInterpolate(t.valueToDisplay())}}var v={provide:c,useExisting:u(()=>f),multi:!0},f=(()=>{class o{document;renderer;cd;el;styleClass;style;ariaLabel;ariaLabelledBy;tabindex=0;valueColor="var(--primary-color, Black)";rangeColor="var(--surface-border, LightGray)";textColor="var(--text-color-secondary, Black)";valueTemplate="{value}";name;size=100;step=1;min=0;max=100;strokeWidth=14;disabled;showValue=!0;readonly=!1;onChange=new m;radius=40;midX=50;midY=50;minRadians=4*Math.PI/3;maxRadians=-Math.PI/3;value=0;windowMouseMoveListener;windowMouseUpListener;windowTouchMoveListener;windowTouchEndListener;onModelChange=()=>{};onModelTouched=()=>{};constructor(t,s,i,n){this.document=t,this.renderer=s,this.cd=i,this.el=n}mapRange(t,s,i,n,a){return(t-s)*(a-n)/(i-s)+n}onClick(t){!this.disabled&&!this.readonly&&this.updateValue(t.offsetX,t.offsetY)}updateValue(t,s){let i=t-this.size/2,n=this.size/2-s,a=Math.atan2(n,i),l=-Math.PI/2-Math.PI/6;this.updateModel(a,l)}updateModel(t,s){let i;if(t>this.maxRadians)i=this.mapRange(t,this.minRadians,this.maxRadians,this.min,this.max);else if(t<s)i=this.mapRange(t+2*Math.PI,this.minRadians,this.maxRadians,this.min,this.max);else return;let n=Math.round((i-this.min)/this.step)*this.step+this.min;this.value=n,this.onModelChange(this.value),this.onChange.emit(this.value)}onMouseDown(t){if(!this.disabled&&!this.readonly){let s=this.document.defaultView||"window";this.windowMouseMoveListener=this.renderer.listen(s,"mousemove",this.onMouseMove.bind(this)),this.windowMouseUpListener=this.renderer.listen(s,"mouseup",this.onMouseUp.bind(this)),t.preventDefault()}}onMouseUp(t){!this.disabled&&!this.readonly&&(this.windowMouseMoveListener&&(this.windowMouseMoveListener(),this.windowMouseUpListener=null),this.windowMouseUpListener&&(this.windowMouseUpListener(),this.windowMouseMoveListener=null),t.preventDefault())}onTouchStart(t){if(!this.disabled&&!this.readonly){let s=this.document.defaultView||"window";this.windowTouchMoveListener=this.renderer.listen(s,"touchmove",this.onTouchMove.bind(this)),this.windowTouchEndListener=this.renderer.listen(s,"touchend",this.onTouchEnd.bind(this)),t.preventDefault()}}onTouchEnd(t){!this.disabled&&!this.readonly&&(this.windowTouchMoveListener&&this.windowTouchMoveListener(),this.windowTouchEndListener&&this.windowTouchEndListener(),this.windowTouchMoveListener=null,this.windowTouchEndListener=null,t.preventDefault())}onMouseMove(t){!this.disabled&&!this.readonly&&(this.updateValue(t.offsetX,t.offsetY),t.preventDefault())}onTouchMove(t){if(!this.disabled&&!this.readonly&&t instanceof TouchEvent&&t.touches.length===1){let s=this.el.nativeElement.children[0].getBoundingClientRect(),i=t.targetTouches.item(0);if(i){let n=i.clientX-s.left,a=i.clientY-s.top;this.updateValue(n,a)}}}updateModelValue(t){t>this.max?this.value=this.max:t<this.min?this.value=this.min:this.value=t,this.onModelChange(this.value),this.onChange.emit(this.value)}onKeyDown(t){if(!this.disabled&&!this.readonly)switch(t.code){case"ArrowRight":case"ArrowUp":{t.preventDefault(),this.updateModelValue(this._value+1);break}case"ArrowLeft":case"ArrowDown":{t.preventDefault(),this.updateModelValue(this._value-1);break}case"Home":{t.preventDefault(),this.updateModelValue(this.min);break}case"End":{t.preventDefault(),this.updateModelValue(this.max);break}case"PageUp":{t.preventDefault(),this.updateModelValue(this._value+10);break}case"PageDown":{t.preventDefault(),this.updateModelValue(this._value-10);break}}}writeValue(t){this.value=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}containerClass(){return{"p-knob p-component":!0,"p-disabled":this.disabled}}rangePath(){return`M ${this.minX()} ${this.minY()} A ${this.radius} ${this.radius} 0 1 1 ${this.maxX()} ${this.maxY()}`}valuePath(){return`M ${this.zeroX()} ${this.zeroY()} A ${this.radius} ${this.radius} 0 ${this.largeArc()} ${this.sweep()} ${this.valueX()} ${this.valueY()}`}zeroRadians(){return this.min>0&&this.max>0?this.mapRange(this.min,this.min,this.max,this.minRadians,this.maxRadians):this.mapRange(0,this.min,this.max,this.minRadians,this.maxRadians)}valueRadians(){return this.mapRange(this._value,this.min,this.max,this.minRadians,this.maxRadians)}minX(){return this.midX+Math.cos(this.minRadians)*this.radius}minY(){return this.midY-Math.sin(this.minRadians)*this.radius}maxX(){return this.midX+Math.cos(this.maxRadians)*this.radius}maxY(){return this.midY-Math.sin(this.maxRadians)*this.radius}zeroX(){return this.midX+Math.cos(this.zeroRadians())*this.radius}zeroY(){return this.midY-Math.sin(this.zeroRadians())*this.radius}valueX(){return this.midX+Math.cos(this.valueRadians())*this.radius}valueY(){return this.midY-Math.sin(this.valueRadians())*this.radius}largeArc(){return Math.abs(this.zeroRadians()-this.valueRadians())<Math.PI?0:1}sweep(){return this.valueRadians()>this.zeroRadians()?0:1}valueToDisplay(){return this.valueTemplate.replace("{value}",this._value.toString())}get _value(){return this.value!=null?this.value:this.min}static ɵfac=function(s){return new(s||o)(e.ɵɵdirectiveInject(h),e.ɵɵdirectiveInject(e.Renderer2),e.ɵɵdirectiveInject(e.ChangeDetectorRef),e.ɵɵdirectiveInject(e.ElementRef))};static ɵcmp=e.ɵɵdefineComponent({type:o,selectors:[["p-knob"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",tabindex:"tabindex",valueColor:"valueColor",rangeColor:"rangeColor",textColor:"textColor",valueTemplate:"valueTemplate",name:"name",size:"size",step:"step",min:"min",max:"max",strokeWidth:"strokeWidth",disabled:"disabled",showValue:"showValue",readonly:"readonly"},outputs:{onChange:"onChange"},features:[e.ɵɵProvidersFeature([v])],decls:5,vars:24,consts:[[3,"ngClass","ngStyle"],["viewBox","0 0 100 100","role","slider",3,"click","keydown","mousedown","mouseup","touchstart","touchend"],[1,"p-knob-range"],[1,"p-knob-value"],["text-anchor","middle","class","p-knob-text",4,"ngIf"],["text-anchor","middle",1,"p-knob-text"]],template:function(s,i){s&1&&(e.ɵɵelementStart(0,"div",0),e.ɵɵnamespaceSVG(),e.ɵɵelementStart(1,"svg",1),e.ɵɵlistener("click",function(a){return i.onClick(a)})("keydown",function(a){return i.onKeyDown(a)})("mousedown",function(a){return i.onMouseDown(a)})("mouseup",function(a){return i.onMouseUp(a)})("touchstart",function(a){return i.onTouchStart(a)})("touchend",function(a){return i.onTouchEnd(a)}),e.ɵɵelement(2,"path",2)(3,"path",3),e.ɵɵtemplate(4,p,2,5,"text",4),e.ɵɵelementEnd()()),s&2&&(e.ɵɵclassMap(i.styleClass),e.ɵɵproperty("ngClass",i.containerClass())("ngStyle",i.style),e.ɵɵattribute("data-pc-name","knob")("data-pc-section","root"),e.ɵɵadvance(1),e.ɵɵstyleProp("width",i.size+"px")("height",i.size+"px"),e.ɵɵattribute("aria-valuemin",i.min)("aria-valuemax",i.max)("aria-valuenow",i._value)("aria-labelledby",i.ariaLabelledBy)("aria-label",i.ariaLabel)("tabindex",i.readonly||i.disabled?-1:i.tabindex)("data-pc-section","svg"),e.ɵɵadvance(1),e.ɵɵattribute("d",i.rangePath())("stroke-width",i.strokeWidth)("stroke",i.rangeColor),e.ɵɵadvance(1),e.ɵɵattribute("d",i.valuePath())("stroke-width",i.strokeWidth)("stroke",i.valueColor),e.ɵɵadvance(1),e.ɵɵproperty("ngIf",i.showValue))},dependencies:[r.NgClass,r.NgIf,r.NgStyle],styles:[`@keyframes dash-frame{to{stroke-dashoffset:0}}@layer primeng{.p-knob-range{fill:none;transition:stroke .1s ease-in}.p-knob-value{animation-name:dash-frame;animation-fill-mode:forwards;fill:none}.p-knob-text{font-size:1.3rem;text-align:center}}
`],encapsulation:2,changeDetection:0})}return o})(),L=(()=>{class o{static ɵfac=function(s){return new(s||o)};static ɵmod=e.ɵɵdefineNgModule({type:o});static ɵinj=e.ɵɵdefineInjector({imports:[d]})}return o})();export{v as KNOB_VALUE_ACCESSOR,f as Knob,L as KnobModule};